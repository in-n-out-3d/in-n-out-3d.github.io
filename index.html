<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Our work focuses on OOD inversion based on 3D GAN.">
  <meta name="keywords" content="GAN inversion, out-of-distribution data, editing">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>In-N-Out</title>


  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="stylesheet" href="./static/css/select.css">
  <link rel="icon" href="">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/select.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

  <nav class="navbar" role="navigation" aria-label="main navigation" style="position: fixed; top: 0; width: 100%;">
    <div class="navbar-brand">
      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>
    <div class="navbar-menu">
      <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
        <a class="navbar-item" href="">
        <span class="icon">
            <i class="fas fa-home"></i>
        </span>
        </a>
  
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">
            Table of Contents
          </a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#rec_image_container">
              Reconstruction on Internet Images
            </a>
            <a class="navbar-item" href="#editing_image_container">
              Semantic editing on Internet Images
            </a>
            <a class="navbar-item" href="#nvs_image_container">
              View synthesis on Internet Images
            </a>
            <a class="navbar-item" href="#rec_video_container">
              Reconstruction on Internet Videos
            </a>
            <a class="navbar-item" href="#editing_video_container">
              Semantic editing on Internet Videos
            </a>
            <a class="navbar-item" href="#removal_container">
              OOD object removal on Internet videos
            </a>
            <a class="navbar-item" href="#ablation">
              Ablation study
            </a>
            <a class="navbar-item" href="#failure">
              Failure cases
            </a>
          </div>
        </div>
      </div>
  
    </div>
  </nav>

<section class="hero">
  <div class="hero-body">
    <div class="container">
      <div class="columns is-centered">
        <div class="column has-text-centered">
         <h1 class="col-md-12 text-center" style="font-size:32px;" id="title">
            <b>In-N-Out</b>: Faithful 3D GAN Inversion with Volumetric Decomposition for Face Editing
    
          </h1>        
          
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://twizwei.github.io/">Yiran Xu</a><sup>&#128034</sup>,</span>
            <span class="author-block">
              <a href="https://zhixinshu.github.io/">Zhixin Shu</a><sup><img src="./static/images/adobe.png" width="20"/></sup>,</span>
            <span class="author-block">
                <a href="https://research.adobe.com/person/cameron-smith/">Cameron Smith</a><sup><img src="./static/images/adobe.png" width="20"/></sup>,</span>
            <span class="author-block">
                <a href="https://sites.google.com/view/seoungwugoh/">Seoung Wug Oh</a><sup><img src="./static/images/adobe.png" width="20"/></sup></span>
            </span>
            <span class="author-block">
              <a href="https://jbhuang0604.github.io/">Jia-Bin Huang</a><sup>&#128034</sup>,</span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>&#128034</sup>University of Maryland, College Park,</span>
            <span class="author-block"><sup><img src="./static/images/adobe.png" width="20"/></sup>Adobe Research</span>
          </div>

          <div class="is-size-3 publication-authors">
            <span class="author-block">CVPR 2024</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">              
              <!-- arxiv Link. -->
              <span class="link-block">
                <a href="http://arxiv.org/abs/2302.04871" class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- arxiv Link. -->

              <!-- PDF Link. -->
              <span class="link-block">
                <a href="./static/images/supp.pdf"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Supp PDF</span>
                </a>
              </span>
              <!-- PDF Link. -->

              <!-- Video Link. -->
              <span class="link-block">
                <a href="https://www.youtube.com/watch?v=JGbLEEANtnI" class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="fab fa-youtube"></i> 
                  </span>
                  <span>Video</span>
                </a>
              </span>
              <!-- Video Link. -->
              
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/Twizwei/in-n-out" class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <svg class="svg-inline--fa fa-github fa-w-16" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-fa-i2svg=""><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><!-- <i class="fab fa-github"></i> Font Awesome fontawesome.com -->
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <span class="link-block">
                <a href="https://drive.google.com/file/d/1PRWZvLxtZexDG4PHTPiyp0WR0VFZoJFD/view?usp=sharing"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a>
              </span>
              <span class="link-block">
                <a href="#BibTeX"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-book"></i>
                  </span>
                  <span>BibTex</span>
                  </a>
              </span>

              <br> </br>
              
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-rednose2">
          <video poster="" id="rednose2" autoplay controls muted loop playsinline webkit-playsinline height="100%">
            <source src="./static/results/rednose2_demo.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-halloween1">
          <video poster="" id="halloween1" autoplay controls muted loop playsinline webkit-playsinline height="100%">
            <source src="./static/results/Halloween1_demo.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-halloween4">
          <video poster="" id="halloween4" autoplay controls muted loop playsinline webkit-playsinline height="100%">
            <source src="./static/results/Halloween4_demo.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-halloween3">
          <video poster="" id="halloween3" autoplay controls muted loop playsinline webkit-playsinline height="100%">
            <source src="./static/results/Halloween3_demo.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-halloween6">
          <video poster="" id="halloween6" autoplay controls muted loop playsinline webkit-playsinline height="100%">
            <source src="static/results/Halloween6_demo.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-mask1">
          <video poster="" id="mask1" autoplay controls muted loop playsinline webkit-playsinline height="100%">
            <source src="static/results/mask1_demo.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            3D-aware GANs offer new capabilities for view synthesis while preserving the editing functionalities of their 2D counterparts.
            GAN inversion is a crucial step that seeks the latent code to reconstruct input images or videos, subsequently enabling diverse editing tasks through manipulation of this latent code. 
            However, a model pre-trained on a particular dataset (e.g., FFHQ) often has difficulty reconstructing images with out-of-distribution (OOD) objects such as faces with heavy make-up or occluding objects. 
            We address this issue by explicitly modeling OOD objects from the input in 3D-aware GANs.
            Our core idea is to represent the image using two individual neural radiance fields: one for the in-distribution content and the other for the out-of-distribution object. The final reconstruction is achieved by optimizing the composition of these two radiance fields with carefully designed regularization.
            We demonstrate that our explicit decomposition alleviates the inherent trade-off between reconstruction fidelity and editability.
            We evaluate reconstruction accuracy and editability of our method on challenging real face images and videos and showcase favorable results against other baselines.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    
    <!-- Paper video. -->
    <!-- <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video (dummy video for now)</h2>
        <div class="publication-video">
          <iframe src="https://www.youtube.com/embed/Vs0adTploEU"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div> -->
    <!--/ Paper video. -->

    <!-- Method. -->
    <div class="container has-text-centered is-max-desktop">
        <h2 class="title is-3">Method Overview</h2>
        <img src="static/images/Overview.jpg" alt="method overview" style="width:100%;" >
    </div>
    <!--/ Method. -->
    
  </div>
</section>


<section class="section">
  <div class="container ">

    <!-- Results. -->
    <h2 class="title is-3">Single image</h2>

    <section class="section">
      <h3 id="rec_image_container" class="title is-4">Reconstruction on Internet Images</h3>
      <p class="description-text">
        Our method can be applied to diverse images from the Internet. 
        We show reconstruction results from single images below.
      </p>
      <br></br>
      <div class="container is-fluid">
        <div class="columns is-centered has-text-centered">
          <div class="column">
            <div class="column has-text-centered">
              <div class="publication-links">
                  <!-- Description for Slider -->
                  <div class="slider-description">
                    <p>Slide to switch between different images</p>
                  </div>

                  <!-- Slider for Image Selection -->
                  <div class="slider-container">
                      <input type="range" min="0" max="9" value="0" id="imageSlider1" oninput="updateImages(this.value)">
                      <span id="imageIndexDisplay1">0</span>/10 <!-- Display for the current image index -->
                  </div>
                  <!-- Description for buttons -->
                  <div class="button-description">
                    <p>Click to switch between different methods.</p>
                  </div>
                  <span class="link-block external-link button is-normal is-rounded is-dark"
                        onclick="changeMethod('w')">
                    <span>W</span>
                  </span>
                  <span class="link-block external-link button is-normal is-rounded is-dark"
                        onclick="changeMethod('wplus')">
                    <span>W+</span>
                  </span>
                  <span class="link-block external-link button is-normal is-rounded is-dark"
                        onclick="changeMethod('ide3d')">
                    <span>IDE-3D</span>
                  </span>
                  <span class="link-block external-link button is-normal is-rounded is-dark"
                        onclick="changeMethod('pti')">
                    <span>PTI</span>
                  </span>
                  <span class="link-block external-link button is-normal is-rounded is-dark"
                        onclick="changeMethod('goae')">
                    <span>GOAE</span>
                  </span>
                  <span class="link-block external-link button is-normal is-rounded is-dark"
                        onclick="changeMethod('hfgi3d')">
                    <span>HFGI3D</span>
                  </span>
              </div>
            </div>
            <!-- Image Display -->
            <div id="imageDisplay" class="columns">
              <div><h4>Input</h4><img id="inputImage" src="" alt="Input Image"></div>
              <div><h4 id="methodTitle">W</h4><img id="methodImage" src="" alt="Method Image"></div>
              <div><h4>Ours</h4><img id="oursImage" src="" alt="Ours Image"></div>
            </div>
          </div>
        </div>
      </div>      
      <br> </br>
      <!-- <ul><li><a href="#contents" style="font-size: 20px;">&uarr;Back to top menu</a></li></ul> -->
    </section>
      
    <h3 id="editing_image_container" class="title is-4">Semantic editing on Internet Images</h3>
    <p>
      We can edit it with available semantic editing methods, e.g., InterfaceGAN, StyleCLIP.
    </p>
    <section class="section">
      <div class="container is-fluid">
          <div class="columns is-centered has-text-centered">
              <div class="column">
                  <div class="column has-text-centered">
  
                      <!-- Description for Slider -->
                      <div class="slider-description">
                        <p>Slide to switch between different images</p>
                      </div>

                      <!-- Slider for Image Selection -->
                      <div class="slider-container">
                        <input type="range" min="0" max="4" value="0" id="imageSlider2" oninput="updateDisplay(this.value)">
                        <span id="imageIndexDisplay2">0</span>/5 <!-- Display for the current image index -->
                      </div>
                      
                      <!-- Description for buttons -->
                      <div class="button-description">
                        <p>Click to switch between different methods or editing directions.</p>
                      </div>
                      <!-- Buttons for Method Selection -->
                      <div class="method-buttons">
                        <span class="method-label">Method:</span> 
                        <span class="link-block external-link button is-normal is-rounded is-dark"
                              onclick="changeMethodwAttribute('w')">
                          <span>W</span>
                        </span>
                        <span class="link-block external-link button is-normal is-rounded is-dark"
                              onclick="changeMethodwAttribute('wplus')">
                          <span>W+</span>
                        </span>
                        <span class="link-block external-link button is-normal is-rounded is-dark"
                              onclick="changeMethodwAttribute('ide3d')">
                          <span>IDE-3D</span>
                        </span>
                        <span class="link-block external-link button is-normal is-rounded is-dark"
                              onclick="changeMethodwAttribute('pti')">
                          <span>PTI</span>
                        </span>
                        <span class="link-block external-link button is-normal is-rounded is-dark"
                              onclick="changeMethodwAttribute('goae')">
                          <span>GOAE</span>
                        </span>
                        <span class="link-block external-link button is-normal is-rounded is-dark"
                              onclick="changeMethodwAttribute('hfgi3d')">
                          <span>HFGI3D</span>
                        </span>
                        <!-- Add other method buttons here -->
                      </div>
  
                      <!-- Buttons for Attribute Selection -->
                      <div class="attribute-buttons">
                        <span class="attribute-label">Editing:</span> 
                        <span class="link-block external-link button is-normal is-rounded is-dark"
                            onclick="changeAttribute('eyeglasses')">
                        <span>eyeglasses</span>
                        </span>
                        <span class="link-block external-link button is-normal is-rounded is-dark"
                            onclick="changeAttribute('elsa')">
                          <span>Elsa</span>
                        </span>
                        <span class="link-block external-link button is-normal is-rounded is-dark"
                            onclick="changeAttribute('younger')">
                          <span>younger</span>
                        </span>
                        <span class="link-block external-link button is-normal is-rounded is-dark"
                            onclick="changeAttribute('smile')">
                          <span>smile</span>
                        </span>
                        <span class="link-block external-link button is-normal is-rounded is-dark"
                            onclick="changeAttribute('surprised')">
                          <span>surprised</span>
                        </span>
                        <!-- Add other attribute buttons here -->
                      </div>
  
                  </div>
                  <div class="current-attribute">
                    <p><span id="currentAttributeDisplay1">eyeglasses</span></p>
                  </div>
                  <div id="imageGridContainer" class="columns">
                      <!-- Images will be displayed here -->
                  </div>
                  
              </div>
          </div>
      </div>
    </section>
  
    <!-- <ul><li><a href="#contents" style="font-size: 20px;">&uarr;Back to top menu</a></li></ul> -->
    <br> </br>

      <h3 class="title is-4" id="nvs_image_container">View synthesis on Internet Images</h3>
      <p>
        Unlike HFGI3D, which warps and computes visibility map, resulting a time-consuming optimization,
        our method only relies on a depth map from MiDaS, and can synthesize faithful views.
      </p>
      <br></br>
      <section class="section">
        <!-- Description for Slider -->
        <div class="slider-description">
          <p>Slide to switch between different images</p>
        </div>
        <!-- Slider for Image Selection -->
        <div class="slider-container">
          <input type="range" min="0" max="2" value="0" id="imageSlider3" oninput="updateDisplayNVSImage(this.value)">
          <span id="imageIndexDisplay">0</span>/3
        </div>
        <!-- Method Buttons -->
        <div class="method-buttons">
          <span class="method-label">Method:</span> 
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodNVSImage('w')">
            <span>W</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodNVSImage('wplus')">
            <span>W+</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodNVSImage('ide3d')">
            <span>IDE-3D</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodNVSImage('pti')">
            <span>PTI</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodNVSImage('goae')">
            <span>GOAE</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodNVSImage('hfgi3d')">
            <span>HFGI3D</span>
          </span>
          <!-- Add other method buttons here -->
        </div>
    
        <!-- Image Display -->
        <div id="imageDisplayNVS" class="columns">
            <!-- Images will be dynamically inserted here -->
        </div>
    
        
      </section>
      <!-- <ul><li><a href="#contents" style="font-size: 20px;">&uarr;Back to top menu</a></li></ul> -->
      <br> </br>

      <!-- Internet Video -->
      <h2 class="title is-3">Videos</h2>
      <h3 class="title is-4" id="rec_video_container">Reconstruction on Internet Videos</h3>
      <p>
        Our method can be applied to diverse videos from the Internet. 
        We show reconstruction results below.
      </p>
      <section class="section">
        <div class="slider-description">
          <p>Slide to switch between different videos</p>
        </div>
        <!-- Slider for Video Selection -->
        <div class="slider-container">
          <input type="range" min="0" max="1" value="0" id="videoSlider1" oninput="updateDisplayInvVideo(this.value)">
          <span id="videoIndexDisplay1">0</span>/2
        </div>
        <!-- Method Buttons -->
        <div class="method-buttons">
          <span class="method-label">Method:</span> 
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodInvVideo('w')">
            <span>W</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodInvVideo('wplus')">
            <span>W+</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodInvVideo('ide3d')">
            <span>IDE-3D</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodInvVideo('pti')">
            <span>PTI</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodInvVideo('goae')">
            <span>GOAE</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
              onclick="changeMethodInvVideo('hfgi3d')">
          <span>HFGI3D</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
              onclick="changeMethodInvVideo('vive3d')">
          <span>VIVE3D</span>
          </span>
        </div>
    
        <!-- Video Display -->
        <div id="videoDisplay" class="columns">
            <!-- Videos will be dynamically inserted here -->
        </div>
    
        
    </section>
      <!-- <ul><li><a href="#contents" style="font-size: 20px;">&uarr;Back to top menu</a></li></ul> -->
      <br> </br>

      <h3 class="title is-4" id="editing_video_container">Semantic editing on Internet Videos</h3>
      <p>
        We can edit it with available semantic editing methods, e.g., InterfaceGAN, StyleCLIP.
      </p>

      <section class="section">
        <div class="container is-fluid">

          <!-- Description for Slider -->
          <div class="slider-description">
            <p>Slide to switch between different videos.</p>
          </div>

          <!-- Slider for Image Selection -->
          <div class="slider-container">
            <input type="range" min="0" max="2" value="0" id="videoSlider2" oninput="updateDisplayEditVideo(this.value)">
            <span id="videoIndexDisplay2">0</span>/3
          </div>

          <!-- Buttons for Method Selection -->
          <div class="method-buttons">
            <span class="method-label">Method:</span> 
            <span class="link-block external-link button is-normal is-rounded is-dark"
                  onclick="changeMethodEditVideo('w')">
              <span>W</span>
            </span>
            <span class="link-block external-link button is-normal is-rounded is-dark"
                  onclick="changeMethodEditVideo('wplus')">
              <span>W+</span>
            </span>
            <span class="link-block external-link button is-normal is-rounded is-dark"
                  onclick="changeMethodEditVideo('ide3d')">
              <span>IDE-3D</span>
            </span>
            <span class="link-block external-link button is-normal is-rounded is-dark"
                  onclick="changeMethodEditVideo('pti')">
              <span>PTI</span>
            </span>
            <span class="link-block external-link button is-normal is-rounded is-dark"
                  onclick="changeMethodEditVideo('goae')">
              <span>GOAE</span>
            </span>
            <span class="link-block external-link button is-normal is-rounded is-dark"
                  onclick="changeMethodEditVideo('hfgi3d')">
              <span>HFGI3D</span>
            </span>
            <span class="link-block external-link button is-normal is-rounded is-dark"
                  onclick="changeMethodEditVideo('vive3d')">
              <span>VIVE3D</span>
            </span>
            <!-- Add other method buttons here -->
          </div>

          <!-- Buttons for Attribute Selection -->
          <div class="attribute-buttons">
            <span class="attribute-label">Editing:</span> 
            <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeAttributeEditVideo('eyeglasses')">
            <span>eyeglasses</span>
            </span>
            <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeAttributeEditVideo('elsa')">
              <span>Elsa</span>
            </span>
            <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeAttributeEditVideo('younger')">
              <span>younger</span>
            </span>
            <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeAttributeEditVideo('smile')">
              <span>smile</span>
            </span>
            <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeAttributeEditVideo('surprised')">
              <span>surprised</span>
            </span>
            <!-- Add other attribute buttons here -->
          </div>
            <div class="current-attribute">
              <p><span id="currentAttributeDisplay2">eyeglasses</span></p>
            </div>
            <div id="videoGridContainer" class="columns"></div>
        </div>
      </section>
      <!-- <ul><li><a href="#contents" style="font-size: 20px;">&uarr;Back to top menu</a></li></ul> -->
      <br> </br>

      <!-- Novel view synthesis -->
      <h3 class="title is-4">View synthesis on Internet videos</h3>
      <p>
        After reconstruction, we can acquire novel views.
      </p>
      <section class="section">
        <!-- Description for Slider -->
        <div class="slider-description">
          <p>Slide to switch between different videos</p>
        </div>
        <!-- Slider for Video Selection -->
        <div class="slider-container">
          <input type="range" min="0" max="2" value="0" id="videoSlider3" oninput="updateDisplayNVSVideo(this.value)">
          <span id="videoIndexDisplay3">0</span>/3
        </div>
        <!-- Method Buttons -->
        <div class="method-buttons">
          <span class="method-label">Method:</span> 
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodNVSVideo('w')">
            <span>W</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodNVSVideo('wplus')">
            <span>W+</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodNVSVideo('ide3d')">
            <span>IDE-3D</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodNVSVideo('pti')">
            <span>PTI</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodNVSVideo('goae')">
            <span>GOAE</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodNVSVideo('hfgi3d')">
            <span>HFGI3D</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
                onclick="changeMethodNVSVideo('vive3d')">
            <span>VIVE3D</span>
          </span>
          <!-- Add other method buttons here -->
        </div>
    
        <!-- Video Display -->
        <div id="videoDisplayNVS" class="columns">
            <!-- Videos will be dynamically inserted here -->
        </div>
      
      <!-- <ul><li><a href="#contents" style="font-size: 20px;">&uarr;Back to top menu</a></li></ul> -->
      <br> </br>

      
      <br> </br>
      <!-- OOD object removal -->
      <h3 class="title is-4" id="removal_container">OOD object removal on Internet videos</h3>
      <p>
        By setting the weight of OOD pixels to 0, we can remove the OOD object.
      </p>
      <br></br>
      <!-- OOD object removal -->
      <div class="container">
        <div id="results-carousel" class="carousel results-carousel">
          <div class="item item-halloween2">
            <video poster="" id="halloween2" autoplay controls muted loop playsinline webkit-playsinline height="100%">
              <source src="./static/results/ladygaga_makeup_oodRemoved_aligned.mp4"
                      type="video/mp4">
            </video>
          </div>
          <div class="item item-rednose2">
            <video poster="" id="rednose2" autoplay controls muted loop playsinline webkit-playsinline height="100%">
              <source src="./static/results/rednose2_oodRemoved_aligned.mp4"
                      type="video/mp4">
            </video>
          </div>
          <div class="item item-pink_glasses">
            <video poster="" id="pink_glasses" autoplay controls muted loop playsinline webkit-playsinline height="100%">
              <source src="static/results/pink_glasses_oodRemoved_aligned.mp4"
                      type="video/mp4">
            </video>
          </div>
          <div class="item item-halloween1">
            <video poster="" id="halloween1" autoplay controls muted loop playsinline webkit-playsinline height="100%">
              <source src="./static/results/Halloween1_oodRemoved_aligned.mp4"
                      type="video/mp4">
            </video>
          </div>
          <div class="item item-halloween4">
            <video poster="" id="halloween4" autoplay controls muted loop playsinline webkit-playsinline height="100%">
              <source src="./static/results/Halloween4_oodRemoved_aligned.mp4"
                      type="video/mp4">
            </video>
          </div>
          <div class="item item-halloween7">
            <video poster="" id="halloween7" autoplay controls muted loop playsinline webkit-playsinline height="100%">
              <source src="static/results/Halloween7_oodRemoved_aligned.mp4"
                      type="video/mp4">
            </video>
          </div>
        </div>
      </div>
      
      <!-- <ul><li><a href="#contents" style="font-size: 20px;">&uarr;Back to top menu</a></li></ul> -->
      <br> </br>

    <h2 class="title is-3" id="ablation">Ablation study</h2>  

    
    <div class="column has-text-centered">
      <div class="publication-links">
          <span class="link-block external-link button is-normal is-rounded is-dark"
               onclick="change_ablation('Lb')">
            <span>Blending weight regularization</span>
          </span>
          <span class="link-block external-link button is-normal is-rounded is-dark"
               onclick="change_ablation('Lw')">
            <span>Latent regularization</span>
          </span>
      </div>
    </div>
    <div class="is-centered" style="width: 100%; margin-left: 0%;">
      <div class="columns">
        <!-- First Video and Caption -->
        <div class="column has-text-centered">
            <video id="video_ablation1" autoplay controls muted loop playsinline width="100%">
              <source id="source_ablation1" src="./static/results/Lb_1.mp4" type="video/mp4">
            </video>
            <div class="captions-grid">
              <p class="caption" id='label-abla1-1'>w/o blending weight regularization</p>
              <p class="caption" id='label-abla1-2'>w/ blending weight regularization (Eqn.6)</p>
            </div>
            
        </div>

        <!-- Second Video and Caption -->
        <div class="column has-text-centered">
            <video id="video_ablation2" autoplay controls muted loop playsinline width="100%">
              <source id="source_ablation2" src="./static/results/Lb_2.mp4" type="video/mp4">
            </video>
            <div class="captions-grid">
              <p class="caption" id='label-abla2-1'>w/o blending weight regularization</p>
              <p class="caption" id='label-abla2-2'>w/ blending weight regularization (Eqn.6)</p>
            </div>
        </div>
        
      </div>
    </div>


    
    

    
    <!-- <ul><li><a href="#contents" style="font-size: 20px;">&uarr;Back to top menu</a></li></ul> -->
    <br> </br>

    <h2 class="title is-3" id="failure">Failure cases</h2>  
    <div class="is-centered" style="width: 100%; margin-left: 0%;">
      <div class="columns">
        <!-- First Video and Caption -->
        <div class="column has-text-centered">
            <video id="video_ablation1" autoplay controls muted loop playsinline width="50%">
              <source id="source_ablation1" src="./static/results/failure1.mp4" type="video/mp4">
            </video>
              <p class="caption" id='label-failure1'>OOD dominates: When editing on the OOD region, 
                e.g., adding eyeglasses to the heavy makeup region, because the blending weights are closer to 1, 
                the eyeglasses in the in-distribution radiance field are hard to be added. 

              </p>
        </div>

        <!-- Second Video and Caption -->
        <div class="column has-text-centered">
            <video id="video_ablation2" autoplay controls muted loop playsinline width="50%">
              <source id="source_ablation2" src="./static/results/failure2.mp4" type="video/mp4">
            </video>
              <p class="caption" id='label-failure2'>Double glasses: Since our OOD radiance field has no knowledge about the GAN and faces prior, 
                when the OOD object itself is glasses, adding eyeglasses introduces duplicate objects. 

              </p>
        </div>
        
      </div>
    </div>
    <!-- <ul><li><a href="#contents" style="font-size: 20px;">&uarr;Back to top menu</a></li></ul> -->
    <br> </br>

  </div>
</section>

<section class="section" id="references">
  <div class="container is-max-desktop content">
    <!-- Concurrent Work. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Related Links</h2>

        <div class="content has-text-justified">
          <p>
            Our method is built upon prior work. We share some useful links below.
          </p>
          <h3 class="title is-5">3D-aware GAN</h3>
            <a href="https://nvlabs.github.io/eg3d/">EG3D</a>: A 3D-aware GAN built upon StyleGAN.
          <h3 class="title is-5">GAN inversion</h3>
            <a href="https://github.com/danielroich/PTI">PTI</a>: A optimization-based (hybrid) GAN inversion method by tuning the generator.<br>
            <a href="https://mrtornado24.github.io/IDE-3D/">IDE-3D</a>: An encoder-based GAN inversion approach.<br>
            <a href="https://eg3d-goae.github.io/">GOAE</a>: An encoder-based GAN inversion approach.<br>
            <a href="https://ken-ouyang.github.io/HFGI3D/index.html">HFGI3D</a>: An optimization-based GAN inversion approach.<br>
            <a href="https://afruehstueck.github.io/vive3D/">VIVE3D</a>: An optimization-based GAN inversion approach for videos.
          <h3 class="title is-5">GAN-based editing</h3>
            <a href="https://arxiv.org/abs/2104.09125">StyleCLIP</a>: A language-based image editing approach via pre-trained StyleGAN.<br>
            <a href="https://arxiv.org/abs/2005.09635">InterfaceGAN</a>: A image editing technique.
        </div>
      </div>
    </div>
    <!--/ Concurrent Work. -->
  </div>
  
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings{xu2024innout,
  author    = {Xu, Yiran and Shu, Zhixin and Smith, Cameron and Oh, Seoung Wug and Huang, Jia-Bin},
  title     = {In-N-Out: Faithful 3D GAN Inversion with Volumetric Decomposition for Face Editing},
  booktitle = {CVPR},
  year      = {2024},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
      <h2 class="title">Acknowledgements</h2>
        <div class="content">
          <p>
            We would like to thank <a href="https://nerfies.github.io/">Nerfies</a> for providing the website <a href="https://github.com/nerfies/nerfies.github.io">source code</a>.
          </p>
          <p>
            The data we are using are from the Internet. We thank for the creators of the videos and images. Please do not use the data for commercial purposes.
          </p>
          <p>
            You can find <a href="./static/images/image_source.txt">video sources</a> and
            <a href="./static/images/image_source.txt">image sources</a> here.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

<script>
  // Call the function when the window has finished loading
  window.onload = function() {
      displayVideos('eyeglasses'); // Replace 'defaultAttribute' with your default attribute
  };
</script>

<script>
  var currentMethod = 'w'; // Default method
  var currentAttribute = 'eyeglasses';

  function updateImages(imageIndex) {
      document.getElementById('inputImage').src = `./static/results/image${imageIndex}_target_00000.png`;
      document.getElementById('methodImage').src = `./static/results/image${imageIndex}_inv_${currentMethod}_00000.png`;
      document.getElementById('oursImage').src = `./static/results/image${imageIndex}_inv_ours_00000.png`;
      var displayMethod = currentMethod === 'wplus' ? 'W+' : currentMethod.toUpperCase();
        document.getElementById('methodTitle').innerText = displayMethod;
      
      // Update the image index display
      document.getElementById('imageIndexDisplay1').innerText = imageIndex;
  }

  function changeMethod(method) {
      currentMethod = method;
      updateImages(document.getElementById('imageSlider1').value);
  }

  // Initialize with the first image
  updateImages(0);

  function updateDisplay(imageIndex) {
    // If imageIndex is not provided, use the value from the slider
    if (imageIndex === undefined) {
        imageIndex = document.getElementById('imageSlider2').value;
    }
    
    // Update the display with the current index
    document.getElementById('imageIndexDisplay2').innerText = imageIndex;

    // Call the function to update images based on this index
    displayImages(currentAttribute, currentMethod, imageIndex);
    
  }

  function changeMethodwAttribute(method) {
    currentMethod = method;
    updateDisplay(); // No need to pass the value; updateDisplay will fetch it
  }

  function changeAttribute(attribute) {
      currentAttribute = attribute;
      updateDisplay(); // No need to pass the value; updateDisplay will fetch it
      // Update the current attribute display
      document.getElementById('currentAttributeDisplay1').innerText = attribute.charAt(0).toUpperCase() + attribute.slice(1); // Capitalize the first letter
  }

  // Initialize with the first image, default method, and attribute
  updateDisplay();

  function changeMethodNVSImage(currentMethod) {
    imageIndex = document.getElementById('imageSlider3').value;
        updateDisplayNVSImage(imageIndex, currentMethod);
    }

  function updateDisplayNVSImage(imageIndex, currentMethod) {
      if (currentMethod === undefined) {
            currentMethod = 'w';
      }
      if (imageIndex === undefined) {
        imageIndex = document.getElementById('imageSlider3').value;
      }
      var inputImagePath = `./static/results/image${imageIndex}_nvs_input.png`;
      var methodImagePath = `./static/results/image${imageIndex}_nvs_${currentMethod}.mp4`; // Change to .png if images
      var oursImagePath = `./static/results/image${imageIndex}_nvs_ours.mp4`; // Change to .png if images
      
      var imageDisplayNVS = document.getElementById('imageDisplayNVS');
      var displayMethod = currentMethod === 'wplus' ? 'W+' : currentMethod.toUpperCase();
        document.getElementById('methodTitle').innerText = displayMethod;
      imageDisplayNVS.innerHTML = `
          <div><h4>Input</h4><img src="${inputImagePath}" alt="Input Image"></div>
          <div><h4>${displayMethod.toUpperCase()}</h4>
              <video autoplay controls muted loop playsinline height="100%">
                  <source src="${methodImagePath}" type="video/mp4">
              </video>
          </div>
          <div><h4>Ours</h4>
              <video autoplay controls muted loop playsinline height="100%">
                  <source src="${oursImagePath}" type="video/mp4">
              </video>
          </div>
      `;
      
      document.getElementById('imageIndexDisplay').innerText = imageIndex;
  }

  // Initialize with the first image and default method
  updateDisplayNVSImage();


  function changeMethodInvVideo(method) {
        currentMethod = method;
        updateDisplayInvVideo(document.getElementById('videoSlider1').value);
    }

  function updateDisplayInvVideo(videoIndex) {
      var inputVideoPath = `./static/results/video${videoIndex}_inv_input.mp4`;
      var methodVideoPath = `./static/results/video${videoIndex}_inv_${currentMethod}.mp4`;
      var oursVideoPath = `./static/results/video${videoIndex}_inv_ours.mp4`;

      var videoDisplay = document.getElementById('videoDisplay');
      var displayMethod = currentMethod === 'wplus' ? 'W+' : currentMethod.toUpperCase();
        document.getElementById('methodTitle').innerText = displayMethod;
      videoDisplay.innerHTML = `
          <div><h4>Input</h4><video autoplay controls muted loop><source src="${inputVideoPath}" type="video/mp4"></video></div>
          <div><h4>${displayMethod.toUpperCase()}</h4><video autoplay controls muted loop><source src="${methodVideoPath}" type="video/mp4"></video></div>
          <div><h4>Ours</h4><video autoplay controls muted loop><source src="${oursVideoPath}" type="video/mp4"></video></div>
      `;

      document.getElementById('videoIndexDisplay1').innerText = videoIndex;
  }

  // Initialize with the first video and default method
  updateDisplayInvVideo(0);

  function changeAttributeEditVideo(attribute) {
        currentAttribute = attribute;
        updateDisplayEditVideo(document.getElementById('videoSlider2').value);
        // Update the current attribute display
        document.getElementById('currentAttributeDisplay2').innerText = attribute.charAt(0).toUpperCase() + attribute.slice(1); // Capitalize the first letter
    }

    function changeMethodEditVideo(method) {
        currentMethod = method;
        updateDisplayEditVideo(document.getElementById('videoSlider2').value);
    }

    function updateDisplayEditVideo(videoIndex) {
        // if (currentMethod === undefined) {
        //       currentMethod = 'w';
        // }
        // if (currentAttribute === undefined) {
        //   currentAttribute = 'eyeglasses';
        // }
        if (videoIndex === undefined) {
          videoIndex = document.getElementById('videoSlider2').value;
        }
        var gridContainer = document.getElementById('videoGridContainer');
        gridContainer.innerHTML = ''; // Clear existing content

        var inputVideoPath = `./static/results/video${videoIndex}_${currentAttribute}_input.mp4`;
        var methodVideoPath = `./static/results/video${videoIndex}_${currentAttribute}_${currentMethod}.mp4`;
        var oursVideoPath = `./static/results/video${videoIndex}_${currentAttribute}_ours.mp4`;

        var videoDisplay = document.getElementById('videoDisplay');
        var displayMethod = currentMethod === 'wplus' ? 'W+' : currentMethod.toUpperCase();
            document.getElementById('methodTitle').innerText = displayMethod;
        gridContainer.innerHTML = `
            <div class="column"><h4>Input</h4><video autoplay controls muted loop><source src="${inputVideoPath}" type="video/mp4"></video></div>
            <div class="column"><h4>${displayMethod.toUpperCase()}</h4><video autoplay controls muted loop><source src="${methodVideoPath}" type="video/mp4"></video></div>
            <div class="column"><h4>Ours</h4><video autoplay controls muted loop><source src="${oursVideoPath}" type="video/mp4"></video></div>
        `;

        document.getElementById('videoIndexDisplay2').innerText = videoIndex;
    }

    // Initialize with the first video, default method, and attribute
    updateDisplayEditVideo(0);

  function changeMethodNVSVideo(currentMethod) {
    videoIndex = document.getElementById('videoSlider3').value;
        updateDisplayNVSVideo(videoIndex, currentMethod);
    }

  function updateDisplayNVSVideo(videoIndex, currentMethod) {
      if (currentMethod === undefined) {
            currentMethod = 'w';
      }
      if (videoIndex === undefined) {
        videoIndex = document.getElementById('videoSlider3').value;
      }
      var inputVideoPath = `./static/results/video${videoIndex}_nvs_input.mp4`;
      var methodVideoPath = `./static/results/video${videoIndex}_nvs_${currentMethod}.mp4`; // Change to .png if images
      var oursVideoPath = `./static/results/video${videoIndex}_nvs_ours.mp4`; // Change to .png if images
      
      var videoDisplayNVS = document.getElementById('videoDisplayNVS');
      var displayMethod = currentMethod === 'wplus' ? 'W+' : currentMethod.toUpperCase();
        document.getElementById('methodTitle').innerText = displayMethod;
      videoDisplayNVS.innerHTML = `
          <div><h4>Input</h4>
              <video autoplay controls muted loop playsinline height="100%">
                  <source src="${inputVideoPath}" type="video/mp4">
              </video>
          </div>
          <div><h4>${displayMethod.toUpperCase()}</h4>
              <video autoplay controls muted loop playsinline height="100%">
                  <source src="${methodVideoPath}" type="video/mp4">
              </video>
          </div>
          <div><h4>Ours</h4>
              <video autoplay controls muted loop playsinline height="100%">
                  <source src="${oursVideoPath}" type="video/mp4">
              </video>
          </div>
      `;
      
      document.getElementById('videoIndexDisplay3').innerText = videoIndex;
  }

  // Initialize with the first image and default method
  updateDisplayNVSVideo();

</script>

</body>
</html>
